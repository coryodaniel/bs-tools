
var Breadcrumb={selector:null,init:function(sel){this.selector=$(sel);return this;},clear:function(remove_root){if(remove_root){this.selector.html('');}else{this.selector.find('li:not(:first-child)').remove();}
return this;},set:function(list,remove_root){this.clear(remove_root);$.each(list,function(k,v){Breadcrumb.push(k,v);});return this;},last:function(){return this.selector.find('a:last').attr('href');},push:function(name,link){var crumb=$('<li>');crumb.append($('<span>').addClass('divider').append($('<i>').addClass('icon-chevron-right')));if(link){crumb.append($('<a>').html(name).attr('href',link)).append($('<span>').html(name).hide());}else{crumb.append($('<span>').html(name));}
this.selector.append(crumb);this.selector.find('li:not(:last-child) a').show();this.selector.find('li:not(:last-child) span:not(.divider)').hide();this.selector.find('li:last-child a').hide();this.selector.find('li:last-child span:not(.divider)').show();return this;},pop:function(){this.selector.find('li:last').remove();return this;}};var HUD=(function(){var queueSize=3;var selector='#headsup';var element,reflection;return{count:function(){return element.find('.alert:visible').length;},init:function(sel,count){if(sel){selector=sel;}
if(count){queueSize=count;}
reflection=this;element=$(selector);return this;},clear:function(){element.empty();return this;},dismiss:function(){element.find('.alert:first-child').slideUp(function(){$(this).remove();});return this;},alert:function(content,heading,block,alertType){var msg=$("<div>").addClass('alert');if(block){msg.addClass('alert-block');}
if(alertType){msg.addClass("alert-"+alertType);}
if(heading){msg.append($("<h4>").addClass("alert-heading").html(heading));}
msg.append(content).prepend($('<a>').addClass('close').data('dismiss','alert').text('×')).hide();element.append(msg);msg.fadeIn(function(){if(reflection.count()>queueSize){reflection.dismiss();}});return this;},warning:function(content,heading,block){return this.alert(content,heading,block,'warning');},error:function(content,heading,block){return this.alert(content,heading,block,'error');},success:function(content,heading,block){return this.alert(content,heading,block,'success');},info:function(content,heading,block){return this.alert(content,heading,block,'info');}};})();var Modal=(function(){var reflection;var ele,isLoading;function body(){if(ele){return ele.find('.modal-body');}}
function footer(){if(ele){return ele.find('.modal-footer');}}
function header(){if(ele){return ele.find('.modal-header');}}
function destroy(){$('.modal-backdrop').remove();if(ele){ele.remove();}
reflection=null;ele=null;}
return{element:function(){return ele;},visible:function(){return!ele.is(":hidden");},hidden:function(){return!this.visible();},setBody:function(html,withForm){isLoading=false;if(withForm){if(footer()){footer().remove()};body().closest('.modal').addClass('modal-form');}
if(this.visible()){body().slideUp(function(){body().removeClass('modal-loading').html(html).slideDown();});}else{body().removeClass('modal-loading').html(html);}
return this;},setTitle:function(text,small){header().find('h3').html(text);if(small){header().find('h3').append($('<small>').html(small));}
return this;},setFooter:function(html){footer().html(html);return this;},clear:function(){footer().empty();header().empty();body().empty();return this;},loading:function(text){if(text){this.setTitle(text,"Loading");}else{this.setTitle("Loading");}
isLoading=true;body().html('').addClass('modal-loading');this.display();return this;},display:function(){ele.modal('show');return this;},toggle:function(){ele.modal('toggle');return this;},hide:function(){ele.modal('hide');return this;},onShown:function(fn,once){if(once){ele.one('shown',fn);}else{ele.on('shown',fn);}
return this;},onHidden:function(fn,once){if(once){ele.one('hidden',fn);}else{ele.on('hidden',fn);}
return this;},reset:function(noFooter){if(reflection){destroy();}
return this.init(noFooter);},init:function(noFooter){if(reflection){return this;}
reflection=this;$('body').append('<div class="modal fade in" id="modal"><div class="modal-header"><a class="close" data-dismiss="modal">×</a><h3>Modal</h3></div><div class="modal-body"></div><div class="modal-footer"><a class="btn cancel modal-cancel">Close</a></div></div>');ele=$('#modal');if(noFooter){footer().empty();}
return this;}};})();